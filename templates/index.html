<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://www.jerryai.me:5566/playgame">
    <meta property="og:type" content="website">
    <meta property="og:title" content="AI亂畫害我輸">
    <meta property="og:description" content="一款讓 AI 亂畫，揪出間諜的遊戲！">
    <meta property="og:image" content="https://www.jerryai.me:5566/static/images/preview.png">
    <meta property="og:locale" content="zh_TW" />

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="jerryai.me">
    <meta property="twitter:url" content="https://www.jerryai.me:5566/playgame">
    <meta name="twitter:title" content="AI亂畫害我輸">
    <meta name="twitter:description" content="一款讓 AI 亂畫，揪出間諜的遊戲！">
    <meta name="twitter:image" content="https://www.jerryai.me:5566/static/images/preview.png">

    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <title>AI亂畫害我輸</title>

    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/animations.css') }}">
</head>

<body class="body">
    <div id="js-scale" class="js-scale">
        <!-- 載入遮罩 -->
        <div id="loading-overlay" class="loading-overlay">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <p id="loading-text">載入中...</p>
            </div>
        </div>
        <!-- JavaScript -->
        <div class="homepage-container" id="homepage-container">
            <!-- <div class="homepage-title">AI亂畫害我輸</div> -->
            <img src="{{ url_for('static', filename='images/logo.png') }}" class="homepage-title-img">
            <div class="homepage-title gelatine">一款讓 AI 亂畫的遊戲！</div>
            <div class="create-join-room">
                <div class="create-join-room-notification" id="create-join-room-notification"></div>
                <div class="create-join-room-container">
                    <div class="room-action">
                        <input class="text-input" type="text" id="host-name" name="name" maxlength="10" size="10"
                            placeholder="暱稱" />
                        <button class="btn btn-primary" id="create-room-submit">
                            創建房間
                        </button>
                    </div>
                    <div class="or-divider">
                        <div class="or-bar"></div>
                        <div>或</div>
                        <div class="or-bar"></div>
                    </div>
                    <div class="room-action">
                        <input class="text-input" type="text" id="room-code" name="name" maxlength="8" size="10"
                            placeholder="房間代號" />
                        <input class="text-input" type="text" id="player-name" name="name" maxlength="10" size="10"
                            placeholder="暱稱" />
                        <button class="btn btn-secondary" id="join-room-submit">
                            加入房間
                        </button>
                    </div>
                </div>
            </div>
            <button class="btn btn-info" id="rules-btn" onclick="showRules()">
                遊戲規則
            </button>
        </div>
        <div class="room-container" id="room-container">
            <div class="room-info">
                <div class="room-title">
                    房間號碼: <span class="room-code selectable high-light" id="my-room-code"></span>
                    <button class="copy-btn" onclick="copyRoomCode()" title="複製房間代碼">
                        <div class="Emoji-clipboard">&#128203;</div>
                    </button>
                </div>
                <div class="room-status">
                    <div class="phase-badge waiting">
                        <span id="room-phase">等待中</span>
                    </div>
                    <span id="player-count" class="player-count">1/8</span>
                    <div class="waiting-tips">
                        <ul>
                            <li>至少需要 3 名玩家才能開始遊戲</li>
                            <li>點擊頭像可以更換您的角色形象</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div id="waiting-area" class="waiting-area">

                <div class="players-grid" id="players-grid">
                    <!-- 玩家卡片將通過 JavaScript 動態生成 -->
                </div>
            </div>
            <div class="room-actions">
                <button id="start-game-btn" class="btn btn-success" onclick="startGame()" style="visibility: hidden">
                    開始遊戲
                </button>
                <button class="btn btn-danger" onclick="leaveRoom()">
                    離開房間
                </button>
            </div>
            <div class="avatar-select-container" id="avatar-select-container">
            </div>
        </div>
        <div class="gametable-container" id="gametable-container">
            <div class="game-header">
                <div class="game-info">
                    <span id="current-round">第 1 輪</span>
                </div>
            </div>
            <div class="game-content">
                <div class="playerblock">
                    <div class="player-avatar-block" id="player-avatar-block-L">
                    </div>
                    <div class="topic-display" id="topic-display">
                        <span class="topic-label">主題</span>
                        <span class="topic-value" id="topic-value"></span>
                    </div>
                </div>
                <div class="drawing-area" id="drawing-interface">
                    <div class="drawing-area-container">
                        <div class="drawing-tips" id="drawing-tips"></div>
                        <div class="topic-vote-area" id="topic-vote-area">
                        </div>
                        <div class="topic-announcement-area" id="topic-announcement-area">
                        </div>
                        <div class="drawing-input-area" id="drawing-input-area">
                            <input class="text-input prompt-input" type="text" id="prompt-text" name="prompt-text"
                                maxlength="30" size="30" placeholder="想繪製的內容..." />
                            <div class="style-option" id="selected-style"><img class="style-option-img"
                                    id="selected-style-image" src="../static/images/styles/real_photo.jpg">
                                <div class="style-introduction-block">
                                    <div class="style-option-name" id="selected-style-name"></div>
                                    <div class="style-option-introduction" id="selected-style-introduction"></div>
                                </div>
                            </div>
                            <div class="drawing-controls">
                                <div id="slot">
                                    <div id="paper-holder">
                                        <div id="paper">
                                            <div class="receipt-content-title receipt-content-bold">RECEIPT 收據</div>
                                            <div class="receipt-store-name">AI亂畫資訊有限公司</div>
                                            <div class="receipt-item">
                                                <div class="receipt-info-title">連線時間:</div>
                                                <div class="receipt-info-content" id="connection-time"></div>
                                            </div>
                                            <div class="receipt-item">
                                                <div class="receipt-info-title">授權碼:</div>
                                                <div class="receipt-info-content" id="authorization-code"></div>
                                            </div>

                                            <div class="receipt-separator">-------------------------------</div>

                                            <div class="receipt-item">
                                                <div class="receipt-content">GPU computing Fee</div>
                                                <div class="receipt-content">0.00</div>
                                            </div>
                                            <div class="receipt-item">
                                                <div class="receipt-text" id="receipt-prompt"></div>
                                                <div class="receipt-content">x1</div>
                                            </div>
                                            <div class="receipt-item">
                                                <div class="receipt-content">Custom Style Fee</div>
                                                <div class="receipt-content">0.00</div>
                                            </div>
                                            <div class="receipt-item">
                                                <div class="receipt-text" id="receipt-style"></div>
                                                <div class="receipt-content">x1</div>
                                            </div>

                                            <div class="receipt-separator">-------------------------------</div>

                                            <div class="total-section">
                                                <div class="receipt-item">
                                                    <div class="receipt-content">金額 AMOUNT:</div>
                                                    <div class="receipt-content-title receipt-content-bold">NT$ 0.00
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="receipt-separator">-------------------------------</div>

                                            <div class="receipt-content">狀態: 已送件</div>
                                            <div class="receipt-content">進度查詢</div>
                                            <img class="qrcode"
                                                src="{{ url_for('static', filename='images/qrcode.svg') }}" height="80"
                                                width="80" />
                                            <div class="receipt-content">*** 客戶收據 CUSTOMER COPY ***</div>
                                        </div>
                                    </div>
                                </div>
                                <button id="submit-order" class="btn btn-warning">提交訂單</button>
                            </div>
                        </div>
                    </div>
                    <div class="style-selection-area" id="style-selection-area">
                        <div class="style-selection-header">
                            <span class="style-selection-title">選擇畫風</span>
                        </div>
                        <div class="style-options-container" id="style-options-container">
                            <!-- 風格選項將通過 JavaScript 動態生成 -->
                        </div>
                    </div>
                </div>
                <div class="art-display-interface" id="art-display-interface">
                    <div class="drawing-tips" id="art-display-tips">正在等待其他玩家選擇繪圖...</div>
                    <div class="artwork-waiting" id="art-waiting-area">
                        <img src="../static/images/gpuCat.png" class="gpuCat wave-step">
                    </div>
                    <div class="art-select-area" id="art-select-area">
                    </div>
                    <div class="art-show" id="art-show-area">
                        <div class="art-show-content" id="art-show-content">
                        </div>
                        <div class="player-info">
                            <div class="player-name" id="showing-creator-name"></div>
                        </div>
                    </div>
                </div>
                <div class="spy-voting" id="spy-voting-interface">
                    <div class="drawing-tips" id="spy-voting-tips">選出誰是間諜？</div>
                    <div class="spy-voting-options" id="spy-voting-options">
                    </div>
                </div>
                <div class="real-spy-interface" id="real-spy-interface">
                </div>
                <div class="spy-guess" id="spy-guess-interface">
                    <div class="drawing-tips" id="spy-guess-tips"></div>
                    <div class="spy-guess-options" id="spy-guess-options">
                    </div>
                </div>
                <div class="spy-guess-result" id="spy-guess-result-interface">
                </div>
                <div class="game-result" id="game-result-interface">
                    <div class="player-celebrate-block" id="player-celebrate-block">
                    </div>
                    <div class="drawing-tips" id="game-result-tips"></div>
                </div>
                <div class="playerblock">
                    <div class="player-avatar-block" id="player-avatar-block-R">
                    </div>
                    <div class="topic-display keyWord-display" id="keyWord-display">
                        <span class="topic-label">關鍵字</span>
                        <span class="topic-value" id="keyWord-value"></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="gallery-container" id="gallery-container">
            <div class="gallery-header">
                <div class="gallery-title">‧ 畫作藝廊 ‧</div>
            </div>
            <div class="gallery-mid-content" id="gallery-mid-content">
                <!-- 畫作將通過 JavaScript 動態生成 -->
            </div>
            <div class="gallery-footer">
                <div class="gallery-player-status" id="gallery-player-status">
                    <!-- 玩家狀態將通過 JavaScript 動態生成 -->
                </div>
                <div class="room-actions">
                    <button class="btn btn-warning" onclick="leaveRoom()">退出遊戲</button>
                    <button class="btn btn-primary" id="play-again-btn" onclick="playAgain()">下場遊戲</button>
                </div>
            </div>
        </div>
        <div class="zoomed-art-container" id="zoomed-art-container">
            <div class="zoomed-art-block" id="zoomed-art-block">
                <img class="zoomed-art-image" id="zoomed-art-image" src="">
                <img class="zoomed-art-frame" id="zoomed-art-frame" src="">
            </div>
        </div>
        <div class="volume-slider-container">
            <img src="{{ url_for('static', filename='images/icons/Speaker.svg') }}" class="volume-icon"
                id="volume-icon">
            <input class="volume-slider" type="range" id="volume" min="0" max="50" value="0">
        </div>
        <div class="rules-container" id="rules-container">
            <div class="close-rules" onclick="hideRules()">
                <img src="../static/images/icons/Dismiss.svg" class="close-icon" id="close-rules-icon">
            </div>
            <div class="rules-content">
                <div class="rules-page-control">
                    <img src="../static/images/icons/Left.svg" class="page-control" id="page-control-left"
                        onclick="changeRulesPage(-1)">
                </div>
                <div class="rules-page" id="rules-page1">
                    <div class="rules-text-area">
                        <p>「AI亂畫害我輸」是一款結合了創意繪畫和社交推理的多人遊戲。</p>
                    </div>
                    <div class="rules-image-area">
                        <img src="../static/images/rule/friends.png" id="friends-image">
                    </div>
                </div>
                <div class="rules-page" id="rules-page2">
                    <div class="rules-text-area">
                        <p>每輪遊戲中，系統會隨機選出一名玩家作為間諜，其他玩家為畫家。</p>
                    </div>
                    <div class="rules-image-area">
                        <div class="role-block">
                            <img src="../static/images/rule/artist.png" id="role-artist">
                            <div class="role-label">畫家</div>
                        </div>
                        <div class="role-block">
                            <img src="../static/images/rule/pigSpy.png" id="role-spy">
                            <div class="role-label">間諜</div>
                        </div>
                    </div>
                </div>
                <div class="rules-page" id="rules-page3">
                    <div class="rules-text-area">
                        <p>所有玩家會選出一個共同的主題，然而關鍵字只有畫家看的到，間諜無法得知。</p>
                        <p>間諜必須通過觀察其他玩家的繪畫來猜測關鍵字。</p>
                    </div>
                    <div class="rules-image-area">
                        <div class="topic-announcement-block">
                            <div class="topic-announcement-display bounce-in" id="topic-announcement-display">
                                <span class="topic-announcement-label">主題</span>
                                <span class="topic-announcement-value">食物</span>
                                <span class="topic-announcement-label">▲ 大家都看的到 ▲</span>
                            </div>
                            <div class="topic-announcement-display keyWord-display bounce-in"
                                id="key-word-announcement-display">
                                <span class="topic-announcement-label">關鍵字</span>
                                <span class="topic-announcement-value">蘋果</span>
                                <span class="topic-announcement-label">▲ 不要讓間諜猜到 ▲</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="rules-page" id="rules-page4">
                    <div class="rule-left-right">
                        <div class="rule-block">
                            <div class="rules-text-area">
                                <p>所有玩家根據主題繪製數張圖畫。</p>
                            </div>
                            <div class="rules-image-area">
                                <img src="../static/images/rule/art.png" id="rule-art-image">
                            </div>

                        </div>
                        <div class="rule-block">
                            <div class="rules-text-area">
                                <p>繪畫完成後，將展示一張選擇的作品。</p>
                            </div>
                            <div class="rules-image-area">
                                <img src="../static/images/rule/showArt.png" id="rule-showArt-image">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="rules-page" id="rules-page5">
                    <div class="rule-left-right">
                        <div class="rule-block">
                            <div class="rules-text-area">
                                <p>兩輪繪畫後，將投票選出最可疑的玩家。</p>
                            </div>
                            <div class="rules-image-area">
                                <img src="../static/images/rule/vote.png" id="rule-vote-image">
                            </div>

                        </div>
                        <div class="rule-block">
                            <div class="rules-text-area">
                                <p>投票結束後，系統會揭曉間諜身份。</p>
                            </div>
                            <div class="rules-image-area">
                                <img src="../static/images/rule/pigSpy.png" id="role-spy">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="rules-page" id="rules-page6">
                    <div class="rule-left-right">
                        <div class="rule-block">
                            <div class="rules-text-area">
                                <p>如果間諜被識破，其他玩家暫時獲勝。</p>
                            </div>
                            <div class="rules-image-area">
                                <img src="../static/images/rule/artistWin.png" id="rule-artistWin-image">
                            </div>

                        </div>
                        <div class="rule-block">
                            <div class="rules-text-area">
                                <p>如果間諜未被識破，則間諜獲得勝利。</p>
                            </div>
                            <div class="rules-image-area">
                                <img src="../static/images/rule/spyWin.png" id="rule-spyWin-image">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="rules-page" id="rules-page7">
                    <div class="rules-text-area">
                        <p>接著，間諜將有一次機會猜出關鍵字</p>
                    </div>
                    <div class="rules-image-area">
                        <img src="../static/images/rule/spyGuess.png" id="rule-spyGuess-image">
                    </div>
                </div>
                <div class="rules-page" id="rules-page8">
                    <div class="rules-text-area">
                        <p>如果間諜沒能猜出關鍵字且已被識破，則畫家獲勝。</p>
                    </div>
                    <div class="rules-image-area">
                        <img src="../static/images/rule/artistWin.png" id="rule-artistWin-image">
                    </div>
                </div>
                <div class="rules-page" id="rules-page9">
                    <div class="rules-text-area">
                        <p>如果間諜猜出關鍵字但已被識破，則間諜逆轉勝。</p>
                        <p>如果間諜猜出關鍵字且未被識破，則間諜大獲全勝。</p>
                    </div>
                    <div class="rules-image-area">
                        <img src="../static/images/rule/spyWin.png" id="rule-spyWin-image">
                    </div>
                </div>
                <div class="rules-page" id="rules-page10">
                    <div class="rules-text-area">
                        <p>遊戲結束後，滑鼠停在玩家的作品上，可以查看當時的指令及作品。</p>
                    </div>
                    <div class="rules-image-area">
                        <img src="../static/images/rule/gallery.png" id="rule-gallery-image">
                    </div>
                </div>
                <div class="rules-page-control">
                    <img src="../static/images/icons/Right.svg" class="page-control" id="page-control-right"
                        onclick="changeRulesPage(1)">
                </div>
            </div>

        </div>
        <div class="follow-interface" id="follow-interface">
        </div>

        <script>
            // 頁面載入完成後隱藏載入遮罩
            window.addEventListener('load', function () {
                initParticles();
            });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.8.1/socket.io.js"></script>
        <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
        <script src="{{ url_for('static', filename='js/audio.js') }}"></script>
        <script src="{{ url_for('static', filename='js/particles.js') }}"></script>
        <script src="{{ url_for('static', filename='js/home.js') }}"></script>
        <script src="{{ url_for('static', filename='js/room.js') }}"></script>
        <script src="{{ url_for('static', filename='js/socket-client.js') }}"></script>
        <script src="{{ url_for('static', filename='js/confetti.js') }}"></script>
</body>

</html>